<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Learning App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <!-- Main Application Container -->
    <div class="bg-white rounded-xl shadow-lg w-full max-w-4xl overflow-hidden">
        
        <!-- Navigation Tabs -->
        <nav class="bg-gray-100 p-4 border-b border-gray-200">
            <div class="flex justify-between items-center space-x-2">
                <button data-tab="dashboard" class="tab-button active px-4 py-2 text-sm md:text-base font-medium rounded-lg text-white bg-indigo-600 hover:bg-indigo-700 transition duration-300">
                    Dashboard
                </button>
                <button data-tab="pronunciation" class="tab-button px-4 py-2 text-sm md:text-base font-medium rounded-lg text-gray-700 hover:text-indigo-600 transition duration-300">
                    Pronunciation
                </button>
                <button data-tab="grammar" class="tab-button px-4 py-2 text-sm md:text-base font-medium rounded-lg text-gray-700 hover:text-indigo-600 transition duration-300">
                    Grammar
                </button>
                <button data-tab="reading" class="tab-button px-4 py-2 text-sm md:text-base font-medium rounded-lg text-gray-700 hover:text-indigo-600 transition duration-300">
                    Reading
                </button>
            </div>
        </nav>

        <!-- Tab Content Sections -->
        <main class="p-6 md:p-8">

            <!-- Dashboard Section -->
            <section id="dashboard" class="tab-content active">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">Welcome Back!</h2>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Progress Card -->
                    <div class="bg-gray-50 p-6 rounded-xl shadow-inner border border-gray-200">
                        <h3 class="text-xl font-semibold text-indigo-600 mb-2">My Progress</h3>
                        <p class="text-sm text-gray-600 mb-4">Track your daily progress and achievements.</p>
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-4xl font-bold text-gray-800" id="streak-counter">0</p>
                                <p class="text-gray-500 text-sm mt-1">Days Streak</p>
                            </div>
                            <div class="relative w-24 h-24">
                                <svg class="w-full h-full" viewBox="0 0 100 100">
                                    <circle class="text-gray-200" stroke-width="8" stroke="currentColor" fill="transparent" r="40" cx="50" cy="50"/>
                                    <circle class="text-green-500" stroke-width="8" stroke-linecap="round" stroke="currentColor" fill="transparent" r="40" cx="50" cy="50"
                                        style="stroke-dasharray: 251.2; stroke-dashoffset: calc(251.2 - (251.2 * var(--progress, 0) / 100));">
                                    </circle>
                                </svg>
                                <span class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-lg font-bold text-gray-700" id="progress-text">0%</span>
                            </div>
                        </div>
                    </div>
                    <!-- Personalized Path Card -->
                    <div class="bg-gray-50 p-6 rounded-xl shadow-inner border border-gray-200">
                        <h3 class="text-xl font-semibold text-indigo-600 mb-2">Your Path</h3>
                        <p class="text-sm text-gray-600">Based on your activity, here are some recommended exercises.</p>
                        <ul class="list-disc list-inside mt-4 space-y-1 text-gray-700 text-sm">
                            <li>Focus on vowel sounds</li>
                            <li>Practice simple past tense</li>
                            <li>Read "The Little Prince"</li>
                        </ul>
                    </div>
                    <!-- Gamified Exercises Card -->
                    <div class="bg-gray-50 p-6 rounded-xl shadow-inner border border-gray-200">
                        <h3 class="text-xl font-semibold text-indigo-600 mb-2">Gamified Drills</h3>
                        <p class="text-sm text-gray-600">Practice with engaging mini-games.</p>
                        <button class="w-full mt-4 py-2 px-4 rounded-lg font-medium text-white bg-indigo-500 hover:bg-indigo-600 transition duration-300">
                            Play "Word Rush"
                        </button>
                    </div>
                </div>
            </section>

            <!-- Pronunciation Section -->
            <section id="pronunciation" class="tab-content">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">Pronunciation Practice</h2>
                <div class="bg-gray-50 p-6 rounded-xl border border-gray-200">
                    <p class="text-sm text-gray-600 mb-4">Click the button and say the following phrase to practice your pronunciation:</p>
                    <p class="text-xl md:text-2xl font-semibold text-gray-800 mb-6">"How are you doing today?"</p>
                    <div class="flex items-center justify-center space-x-4">
                        <button id="record-btn" class="flex items-center justify-center px-6 py-3 bg-red-500 text-white rounded-full hover:bg-red-600 transition duration-300 focus:outline-none">
                           <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a4 4 0 11-8 0 4 4 0 018 0z" />
                           </svg>
                           <span id="record-text">Start Speaking</span>
                        </button>
                    </div>
                    <div id="pronunciation-feedback" class="mt-6 p-4 rounded-lg text-gray-700 bg-white border border-gray-300">
                        <p id="result-text">Your feedback will appear here.</p>
                    </div>
                    <div id="browser-warning" class="mt-4 p-3 rounded-lg bg-yellow-100 text-yellow-800 text-sm hidden">
                        <p>Speech recognition is not fully supported in all browsers or environments. For best results, use Google Chrome.</p>
                    </div>
                </div>
            </section>

            <!-- Grammar Section -->
            <section id="grammar" class="tab-content">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">Grammar Drill</h2>
                <div class="bg-gray-50 p-6 rounded-xl border border-gray-200">
                    <p class="text-lg text-gray-800 mb-4" id="grammar-question"></p>
                    <div id="grammar-options" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Options will be injected here -->
                    </div>
                    <div class="mt-6 p-4 rounded-lg text-gray-700 bg-white border border-gray-300">
                        <p id="grammar-feedback">Select an option above to see feedback.</p>
                    </div>
                </div>
            </section>

            <!-- Reading Section -->
            <section id="reading" class="tab-content">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">Reading Materials</h2>
                <div class="bg-gray-50 p-6 rounded-xl border border-gray-200 overflow-y-auto max-h-[500px]">
                    <h3 class="text-2xl font-semibold text-gray-800 mb-2">The Importance of Bees</h3>
                    <p class="text-sm text-gray-600 mb-4">By a simulated author</p>
                    <p class="text-gray-700 leading-relaxed text-base">
                        Bees are a vital part of our ecosystem, playing an essential role in the pollination of flowering plants. Without them, a large portion of our food supply would be at risk. This process of pollination is crucial for the reproduction of many plants, including a significant number of crops that we rely on for sustenance. As bees fly from flower to flower, they carry pollen, enabling plants to produce seeds and fruits.
                        <br><br>
                        However, bee populations have been in decline due to various factors, such as habitat loss, pesticide use, and climate change. Protecting these important insects is not just an environmental issue; it is a matter of global food security. Governments and organizations around the world are now working to create initiatives that support bee health, including promoting sustainable farming practices and creating bee-friendly habitats. By raising awareness and taking action, we can help ensure the survival of bees and, in turn, the health of our planet.
                    </p>
                </div>
            </section>

        </main>
    </div>

    <script>
        // Check for Web Speech API support
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const recognition = SpeechRecognition ? new SpeechRecognition() : null;

        // UI Elements
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');
        const recordBtn = document.getElementById('record-btn');
        const recordText = document.getElementById('record-text');
        const pronunciationFeedback = document.getElementById('pronunciation-feedback');
        const resultText = document.getElementById('result-text');
        const browserWarning = document.getElementById('browser-warning');

        const grammarQuestionEl = document.getElementById('grammar-question');
        const grammarOptionsEl = document.getElementById('grammar-options');
        const grammarFeedbackEl = document.getElementById('grammar-feedback');

        const streakCounter = document.getElementById('streak-counter');
        const progressText = document.getElementById('progress-text');
        const progressCircle = document.querySelector('circle.text-green-500');

        let streak = 0;
        let progress = 0;

        // Data for grammar drills
        const grammarQuestions = [
            {
                question: "She _____ to the store yesterday.",
                options: ["go", "goes", "went", "going"],
                answer: "went"
            },
            {
                question: "They _____ playing soccer right now.",
                options: ["is", "are", "am", "be"],
                answer: "are"
            },
            {
                question: "I have _____ this movie before.",
                options: ["see", "seen", "saw", "seeing"],
                answer: "seen"
            }
        ];
        let currentGrammarQuestionIndex = 0;

        // --- Core App Logic ---

        // Handle tab switching
        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                const targetTab = button.dataset.tab;

                // Deactivate all buttons and content
                tabButtons.forEach(btn => {
                    btn.classList.remove('active', 'bg-indigo-600', 'text-white');
                    btn.classList.add('text-gray-700', 'hover:text-indigo-600');
                });
                tabContents.forEach(content => {
                    content.classList.remove('active');
                });

                // Activate the selected button and content
                button.classList.add('active', 'bg-indigo-600', 'text-white');
                button.classList.remove('text-gray-700', 'hover:text-indigo-600');
                document.getElementById(targetTab).classList.add('active');

                // Load content for the active tab if needed
                if (targetTab === 'grammar') {
                    loadGrammarQuestion();
                }
            });
        });

        // --- Pronunciation Section Logic ---
        if (recognition) {
            recognition.continuous = false;
            recognition.lang = 'en-US';
            recognition.interimResults = false;
            recognition.maxAlternatives = 1;

            recordBtn.addEventListener('click', () => {
                if (recordText.textContent === 'Start Speaking') {
                    recordText.textContent = 'Listening...';
                    recordBtn.classList.remove('bg-red-500');
                    recordBtn.classList.add('bg-blue-500');
                    resultText.textContent = 'Listening...';
                    recognition.start();
                } else {
                    recordText.textContent = 'Start Speaking';
                    recordBtn.classList.remove('bg-blue-500');
                    recordBtn.classList.add('bg-red-500');
                    recognition.stop();
                }
            });

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                resultText.textContent = `You said: "${transcript}".`;

                // Simple feedback based on a target phrase
                const targetPhrase = "How are you doing today?";
                const similarity = calculateSimilarity(transcript, targetPhrase);

                if (similarity > 0.8) {
                    resultText.textContent += " Great job! Your pronunciation is clear and accurate.";
                } else if (similarity > 0.5) {
                    resultText.textContent += " Good attempt! Practice a little more to improve clarity.";
                } else {
                    resultText.textContent += " Keep trying! Your pronunciation needs more work.";
                }

                recordText.textContent = 'Start Speaking';
                recordBtn.classList.remove('bg-blue-500');
                recordBtn.classList.add('bg-red-500');
                updateProgress();
            };

            recognition.onerror = (event) => {
                resultText.textContent = `Error occurred in speech recognition: ${event.error}`;
                recordText.textContent = 'Start Speaking';
                recordBtn.classList.remove('bg-blue-500');
                recordBtn.classList.add('bg-red-500');
            };

            // Basic similarity check (could be more advanced)
            function calculateSimilarity(str1, str2) {
                const words1 = str1.toLowerCase().split(/\s+/);
                const words2 = str2.toLowerCase().split(/\s+/);
                let intersection = words1.filter(word => words2.includes(word)).length;
                return intersection / Math.max(words1.length, words2.length);
            }

        } else {
            // If API is not supported
            recordBtn.disabled = true;
            recordBtn.textContent = 'Not Supported';
            browserWarning.classList.remove('hidden');
        }

        // --- Grammar Section Logic ---
        function loadGrammarQuestion() {
            const currentQuestion = grammarQuestions[currentGrammarQuestionIndex];
            grammarQuestionEl.textContent = currentQuestion.question;
            grammarOptionsEl.innerHTML = '';
            grammarFeedbackEl.textContent = 'Select an option above to see feedback.';

            currentQuestion.options.forEach(option => {
                const button = document.createElement('button');
                button.textContent = option;
                button.classList.add('p-3', 'rounded-lg', 'font-medium', 'text-gray-700', 'bg-white', 'border', 'border-gray-300', 'hover:bg-indigo-50', 'transition', 'duration-300');
                button.addEventListener('click', () => checkGrammarAnswer(option));
                grammarOptionsEl.appendChild(button);
            });
        }

        function checkGrammarAnswer(selectedOption) {
            const currentQuestion = grammarQuestions[currentGrammarQuestionIndex];
            if (selectedOption === currentQuestion.answer) {
                grammarFeedbackEl.textContent = "Correct! Great job.";
                grammarFeedbackEl.classList.remove('text-red-600');
                grammarFeedbackEl.classList.add('text-green-600');
                updateProgress();
            } else {
                grammarFeedbackEl.textContent = `Incorrect. The correct answer is "${currentQuestion.answer}".`;
                grammarFeedbackEl.classList.remove('text-green-600');
                grammarFeedbackEl.classList.add('text-red-600');
            }
            
            // Move to the next question or loop
            currentGrammarQuestionIndex = (currentGrammarQuestionIndex + 1) % grammarQuestions.length;
            setTimeout(loadGrammarQuestion, 1500); // Load next question after a delay
        }

        // --- Dashboard & Gamification Logic ---
        function updateProgress() {
            streak++;
            progress = Math.min(100, progress + 10); // Example: 10% progress per correct action
            streakCounter.textContent = streak;
            progressText.textContent = `${progress}%`;
            progressCircle.style.setProperty('--progress', progress);
        }

        // Initial load
        window.onload = () => {
            loadGrammarQuestion();
            // Optional: Start a fun initial animation or message.
        };

    </script>
</body>
</html>
